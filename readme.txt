Brian Dean - 3/27/2020
Created during the COVID-19 pandemic of 2020 to help manage DMZ access to internal machines for remote access workers.

Used to query a group in Active Directory and export all computer accounts members and their descriptions to csv, then compile a list of ASA commands to create ASA fqdn objects and add those objects to an object group. 
The py script will send the resulting commands to Solarwind's API for NCM to push to ASAs based on the ASA's IP in the orion-devices.csv file. 

This script can be adapted to a veriaty of purposes. 

I use powershell for the Active Directory query because it's way easier to deal with AD in PS than python. 

File descriptions:
asacommands.txt  - generated by adgrp2asa.py - output of commands sent to Solarwinds NCM. This is only used for reference purposes and is not used in the actual script transfer to Solarwinds NCM.
orion-devices.csv - manual edit - list of IPs of monitored nodes in NCM that the script will send commands to. This ip needs to match the ip monitored in Solarwinds.
adgrp2asa.py - python script that will read computers.csv, create object and object-group commands and send the resulting list of commands to Solarwinds NCM.
computers.csv -  generated by pullgroups.ps1 - csv output of computer accounts and their descriptions in the specified AD group.
pullgroups.ps1 - powershell script that queries AD and exports computer accounts their descriptions to computers.csv. Also runs adgrp2asa.py.

Setup a scheduled task with pullgroups.ps1.

You need to install the Orion Solarwinds SDK for python: https://github.com/solarwinds/orionsdk-python
I was able to install with pip orionsdk.

You must have DNS resolution configured on the ASA. 

As a hint for troubleshooting on the ASA, run "sh dns-hosts" to see if the fqdn objects are getting resolved.
Brians-ASA# sh dns-hosts 

Host                     Flags      Age Type   Address(es)
host1.test.local         (temp, OK) 0    IP    192.168.1.10
host2.test.local         (temp, OK) 0    IP    192.168.1.11

---Setup---
Install the Solarwinds SDK for python
Change the AD group and domain in pullgroups.ps1
Change the servername, username,password for the Orion server in adgrp2asa.py
You can change the object-group and description in adgrp2asa.py to meet your needs.
